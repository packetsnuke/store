!function(a){a(function(){function b(b){b||(b=a(".wc-photography-collections-select")),b.trigger("change.select2"),b=a(b).filter(":not(.enhanced)");var c={placeholder:WCPhotographyCustomerParams.search_placeholder,minimumInputLength:2,multiple:!0,ajax:{url:WCPhotographyCustomerParams.ajax_url,dataType:"json",quietMillis:200,data:function(a){return{term:WCPhotographyCustomerParams.isLessThanWC30?a:a.term,action:"wc_photography_search_collections",security:WCPhotographyCustomerParams.search_collections_nonce}},processResults:function(a){return{results:a}}}};WCPhotographyCustomerParams.isLessThanWC30&&(c.initSelection=function(b,c){var d=a.parseJSON(b.attr("data-selected"));return c(d)},c.formatSelection=function(a){return'<div class="selected-option" data-id="'+a.id+'">'+a.text+"</div>"},c.ajax.results=c.ajax.processResults),b.select2(c).addClass("enhanced")}b(),a("body").on("click",".photography-add-collection a",function(){return a(this).next(".fields").toggle(),!1}).on("click",".photography-add-collection .button",function(){var c=a(this),d=c.closest(".collection-form-field"),e=a("input.new-collection",d),f=e.val();return""===f?(e.focus(),!1):(e.attr("disabled","disabled"),c.attr("disabled","disabled").next(".message").remove(),c.after(' <i class="loading">'+WCPhotographyCustomerParams.loading+"</i>"),a.ajax({url:WCPhotographyCustomerParams.ajax_url,data:{action:"wc_photography_add_collection",security:WCPhotographyCustomerParams.add_collection_nonce,name:f},type:"POST",dataType:"json",success:function(f){if(e.val(""),e.removeAttr("disabled"),c.removeAttr("disabled").next(".loading").remove(),f.success)if(WCPhotographyCustomerParams.isLessThanWC30){var g=a("input.wc-photography-collections-select",d),h=[],i=[];a(".selected-option",d).each(function(b,c){var d=a(c);h.push({id:d.attr("data-id"),text:d.text()}),i.push(d.attr("data-id"))}),h.push(f.data),i.push(f.data.id),g.attr("data-selected",JSON.stringify(h)).val(i.toString()),b(g),a(".fields",d).toggle()}else{var g=a(".wc-photography-collections-select"),j=new Option(f.data.text,f.data.id);j.selected=!0,g.append(j)}else c.after('<div class="error inline message">'+WCPhotographyCustomerParams.collection_error+"</div>")}}),!1)}).on("select2-selecting",".wc-photography-collections-select",function(b){var c=a(this).prev(".wc-photography-collections-select"),d=[];a(".selected-option",c).each(function(b,c){var e=a(c);d.push({id:e.attr("data-id"),text:e.text()})}),d.push({id:b.choice.id,text:b.choice.text}),a(this).attr("data-selected",JSON.stringify(d))}).on("select2-removed",".wc-photography-collections-select",function(){var b=a(this).prev(".wc-photography-collections-select"),c=[];a(".selected-option",b).each(function(b,d){var e=a(d);c.push({id:e.attr("data-id"),text:e.text()})}),a(this).attr("data-selected",JSON.stringify(c))})})}(jQuery);
